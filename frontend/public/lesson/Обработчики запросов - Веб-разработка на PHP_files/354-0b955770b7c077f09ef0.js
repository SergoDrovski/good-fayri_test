"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[354],{61354:function(e,t,n){n.d(t,{Z:function(){return De}});var a=n(67294),r=n(73935),o=n(49226),i=n(24350),c=n.n(i),l=n(56984),s=n(90857),m=n.n(s),u=n(48358),d=n(26793),p=n(84238),f=n.n(p),v=n(94184),h=n.n(v),b=n(87757),y=n.n(b),g=n(39249),E=n(50308),_=n.n(E),k=n(52628),x=n.n(k),N=n(97568),w=n(76403),C=n(82729),I=n.n(C),T=n(98601),Z=n.n(T),S=n(28583),U=n.n(S),R=n(70906),j=n(82492),A=n.n(j),M=n(60546);function L(e,t,n,a,r,o,i){try{var c=e[o](i),l=c.value}catch(s){return void n(s)}c.done?t(l):Promise.resolve(l).then(a,r)}var F=(0,w.hg)("topics/load",function(){var e,t=(e=y().mark((function e(t){var n,a,r,o,i,c,l;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.page,a=t.apiTopicsUrl,r=n+1,(o=new URL(a)).searchParams.append("page",r),e.prev=4,e.next=7,M.Z.get(o.toString());case 7:return i=e.sent,c=i.data,e.abrupt("return",{topics:c.topics});case 12:throw e.prev=12,e.t0=e.catch(4),l=R.Z.t("community.flashes.error"),(0,g.Am)(l),e.t0;case 17:case"end":return e.stop()}}),e,null,[[4,12]])})),function(){var t=this,n=arguments;return new Promise((function(a,r){var o=e.apply(t,n);function i(e){L(o,a,r,i,c,"next",e)}function c(e){L(o,a,r,i,c,"throw",e)}i(void 0)}))});return function(e){return t.apply(this,arguments)}}()),P=(0,w.oM)({name:"topics",initialState:[],reducers:{likeTopic:function(e,t){var n=t.payload;e.find((function(e){return e.id===n.topicId})).likes.push(n.like)},unlikeTopic:function(e,t){var n=t.payload,a=e.find((function(e){return e.id===n.topicId}));I()(a.likes,(function(e){return e.id===n.likeId}))},updateTopic:function(e,t){var n=t.payload;e.find((function(e){return e.id===n.topicId})).title=n.body},toggleUsefulTopic:function(e,t){var n=t.payload;e.find((function(e){return e.id===n.topic.id})).useful=n.topic.useful},assignMentor:function(e,t){var n=t.payload;e.find((function(e){return e.id===n.topic.id})).mentor=n.topic.mentor},changeTopicMentorship:function(e,t){var n=t.payload.topicData,a=e.find((function(e){return e.id===n.id}));A()(a,{kind:n.kind,mentor:n.mentor,mentorship_state:n.mentorship_state})},subscribeToTopic:function(e,t){var n=t.payload;e.find((function(e){return e.id===n.topicId})).subscribers.push(n.subscriber)},unsubscribeFromTopic:function(e,t){var n=t.payload,a=e.find((function(e){return e.id===n.topicId}));I()(a.subscribers,(function(e){return e.id===n.subscriberId}))},removeTopic:function(e,t){var n=t.payload;I()(e,(function(e){return e.id===n.topicId}))},addTopic:function(e,t){var n=t.payload;e.unshift(n.topic)}},extraReducers:function(e){e.addCase(F.fulfilled,(function(e,t){var n=t.payload;e.push.apply(e,n.topics)}))}}),$=Object.assign({},P.actions,{loadTopics:F}),q=P.reducer,H=(0,w.oM)({name:"comments",initialState:{},reducers:{addComment:function(e,t){var n=t.payload;e[n.topic.id][n.comment.id]=n.comment},likeComment:function(e,t){var n=t.payload;e[n.topicId][n.commentId].likes.push(n.like)},markCommentAsSolution:function(e,t){var n=t.payload;e[n.topicId][n.commentId].solution=!0},unmarkCommentAsSolution:function(e,t){var n=t.payload;e[n.topicId][n.commentId].solution=!1},unlikeComment:function(e,t){var n=t.payload;I()(e[n.topicId][n.commentId].likes,(function(e){return e.id===n.likeId}))},updateComment:function(e,t){var n=t.payload;e[n.topicId][n.commentId].body=n.body},removeComment:function(e,t){var n=t.payload;Z()(e[n.topicId],n.commentId)}},extraReducers:function(e){e.addCase($.addTopic,(function(e,t){e[t.payload.topic.id]={}})).addCase($.loadTopics.fulfilled,(function(e,t){var n=t.payload.topics.reduce((function(e,t){var n;return Object.assign({},e,((n={})[t.id]=c()(t.comments,"id"),n))}),{});U()(e,n)}))}}),V=H.actions,O=H.reducer,B=(0,w.oM)({name:"page",initialState:1,reducers:{},extraReducers:function(e){e.addCase(F.fulfilled,(function(e){return e+1}))}}),D=B.actions,z=B.reducer,K=Object.assign({},V,$,D),W=(0,N.UY)({comments:O,topics:q,page:z}),J=a.createContext(null);function G(e,t,n,a,r,o,i){try{var c=e[o](i),l=c.value}catch(s){return void n(s)}c.done?t(l):Promise.resolve(l).then(a,r)}function Q(e){return function(){var t=this,n=arguments;return new Promise((function(a,r){var o=e.apply(t,n);function i(e){G(o,a,r,i,c,"next",e)}function c(e){G(o,a,r,i,c,"throw",e)}i(void 0)}))}}var X=function(e){var t=e.topicId,n=e.showAllComments,r=(0,a.useContext)(J),i=r.currentUser,c=r.mentors,l=(0,o.v9)(function(e,t){return function(n){var a,r=n.topics.find((function(t){return t.id===e})),o=null!=(a=null==r?void 0:r.likes)?a:[],i=o.length,c=o.find((function(e){return e.user_id===t}));return{topic:r,likesCount:i,likeId:null==c?void 0:c.id,comments:x()(n.comments[e]),mentors:n.mentors}}}(t,i.id)),s=l.topic,u=l.likesCount,p=l.likeId,f=l.comments,v=(0,d.$)().t,h=(0,o.I0)(),b=(0,a.useState)(!1),E=b[0],k=b[1],N=(0,a.useState)(n),w=N[0],C=N[1],I=(0,a.useState)(!1),T=I[0],Z=I[1],S=(0,a.useState)(s.title),U=S[0],R=S[1],j=(0,a.useState)(!1),A=j[0],L=j[1],F=(0,a.useState)(""),P=F[0],$=F[1],q=s.subscribers.find((function(e){return e.user_id===i.id})),H=n||w?f:f.slice(-1),V=void 0!==p,O=function(){$(""),L(!1)},B=function(e){return function(){k(!0),e.apply(void 0,arguments).catch((function(){var e=v("community.flashes.error");(0,g.Am)(e)})).finally((function(){k(!1)}))}},D=B(function(){var e=Q(y().mark((function e(n,a){var r,o,i;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.body,o=m().api_topic_path(t,{format:"json"}),i={topic:{title:r}},e.next=5,M.Z.patch(o,i);case 5:h(K.updateTopic({topicId:t,body:r})),a.resetForm(),Z(!1);case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),z=B(Q(y().mark((function e(){var n,a,r;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=m().api_topic_likes_path(t,{format:"json"}),e.next=3,M.Z.post(n);case 3:a=e.sent,r=a.data,h(K.likeTopic({topicId:t,like:r}));case 6:case"end":return e.stop()}}),e)})))),W=B(Q(y().mark((function e(){var n;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=m().api_topic_like_path(t,p,{format:"json"}),e.next=3,M.Z.delete(n);case 3:h(K.unlikeTopic({topicId:s.id,likeId:p}));case 4:case"end":return e.stop()}}),e)})))),G=B(Q(y().mark((function e(){var n,a,r;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=m().toggle_useful_api_topic_path(t,{format:"json"}),e.next=3,M.Z.post(n);case 3:a=e.sent,r=a.data,h(K.toggleUsefulTopic({topic:r}));case 6:case"end":return e.stop()}}),e)})))),X=B(Q(y().mark((function e(){var n,a,r;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=m().assign_mentor_api_topic_path(t,{format:"json"}),e.next=3,M.Z.post(n);case 3:a=e.sent,r=a.data,h(K.assignMentor({topic:r}));case 6:case"end":return e.stop()}}),e)})))),Y=function(){var e=Q(y().mark((function e(n){var a,r;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=m().mentorship_api_topic_path(t,{format:"json"}),r={kind:n.kind,mentor_id:n.mentorId,mentorship_state:n.mentorship_state,previous_mentor_id:n.previousMentorId},e.next=4,M.Z.patch(a,{topic:r});case 4:h(K.changeTopicMentorship({topicData:n}));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ee=B(Q(y().mark((function e(){var n,a,r;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=m().api_topic_subscribers_path(t,{format:"json"}),e.next=3,M.Z.post(n);case 3:a=e.sent,r=a.data,h(K.subscribeToTopic({topicId:t,subscriber:r}));case 6:case"end":return e.stop()}}),e)})))),te=B(Q(y().mark((function e(){var n;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=m().api_topic_subscriber_path(t,q.id,{format:"json"}),e.next=3,M.Z.delete(n);case 3:h(K.unsubscribeFromTopic({topicId:t,subscriberId:q.id}));case 4:case"end":return e.stop()}}),e)})))),ne=B(Q(y().mark((function e(){var n;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=m().api_topic_path(t,{format:"json"}),e.next=3,M.Z.delete(n);case 3:h(K.removeTopic({topicId:t}));case 4:case"end":return e.stop()}}),e)})))),ae=B(function(){var e=Q(y().mark((function e(t,n){var a,r,o,i,c;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.body,r=m().api_topic_comments_path({topic_id:s.id,format:"json"}),o={topic_comment:{body:a}},e.next=5,M.Z.post(r,o);case 5:i=e.sent,c=i.data,h(K.addComment({topic:s,comment:c})),n.resetForm(),O();case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());return{topic:s,fetching:E,likesCount:u,comments:f,subscriber:q,currentUser:i,editing:T,replying:A,replyingText:P,editedTopicText:U,commentsSlice:H,commentsVisible:w,topicHasCurrentUserLike:V,mentors:c,setEditedTopicText:R,closeReplyForm:O,editTopic:function(){R(s.title),Z(!0)},handleLike:function(){return s.can_like?V?W():z():_()()},handleReplyWith:function(e){return void 0===e&&(e=""),function(){$(e),L(!0)}},cancelEditing:function(){R(""),Z(!1)},toggleCommentVisibility:function(){C(!w)},toggleUsefulTopic:G,assignSelfAsMentor:X,subscribeToTopic:ee,unsubscribeFromTopic:te,removeTopic:ne,changeTopicMentorship:Y,updateTopic:D,saveComment:ae}},Y=function(e){var t=e.handleLike,n=e.disabled,r=e.likesCount,o=e.isLiked,i=(0,d.$)().t,c=h()("fa-thumbs-up","ml-2",o?"fas":"far");return a.createElement(u.Z,{title:i("community.buttons.like"),className:"text-muted px-3 py-1 x-link-without-decoration",onClick:t,disabled:n},a.createElement("span",{className:c}),a.createElement("span",{className:"ml-2"},r||null))},ee=n(48962),te=function(e){var t=e.handleUnsubscribe,n=e.handleSubscribe,r=e.canUnsubscribe,o=(0,d.$)().t;return r?a.createElement(ee.Z.Item,{onClick:t},o("community.buttons.unsubscribe_from_topic")):a.createElement(ee.Z.Item,{onClick:n},o("community.buttons.subscribe_to_topic"))},ne=function(e){var t=e.handleRemove,n=e.showRemoveConfirmation,r=e.toggleShowRemoveConfirmation,o=(0,d.$)().t;return n?a.createElement(a.Fragment,null,a.createElement(ee.Z.Item,{className:"mt-3",onClick:r},a.createElement("span",{className:"mr-2 fal fa-ban"}),"\xa0",o("community.buttons.cancel_remove_topic")),a.createElement(ee.Z.Item,{className:"dropdown-item",onClick:t},a.createElement("span",{className:"mr-2 fal fa-trash-alt"}),"\xa0",o("community.buttons.apply_remove_topic"))):a.createElement(ee.Z.Item,{onClick:r},o("community.buttons.delete_topic"))},ae=function(e){var t=e.topic,n=e.handleRemove,r=e.handleEdit,o=e.handleSubscribe,i=e.handleUnsubscribe,c=e.canUnsubscribe,l=(0,d.$)().t,s=(0,a.useState)(!1),m=s[0],u=s[1],p=(0,a.useState)(!1),f=p[0],v=p[1];if(!t.can_subscribe&&!t.can_update&&!t.can_destroy)return null;return a.createElement(ee.Z,{title:l("community.buttons.settings"),show:f,onToggle:function(e,t,n){v("select"===n.source||!f),e&&u(!1)}},a.createElement(ee.Z.Toggle,{variant:"link",size:"sm",className:"text-muted p-0",id:t.id},a.createElement("span",{className:"fal fa-cog"})),a.createElement(ee.Z.Menu,null,t.can_subscribe&&a.createElement(te,{canUnsubscribe:c,handleSubscribe:o,handleUnsubscribe:i}),t.can_update&&a.createElement(ee.Z.Item,{key:"edit",onClick:r},l("community.buttons.edit_topic")),t.can_destroy&&a.createElement(ne,{handleRemove:n,showRemoveConfirmation:m,toggleShowRemoveConfirmation:function(){return u(!m)}})))},re=n(29697);function oe(e,t,n,a,r,o,i){try{var c=e[o](i),l=c.value}catch(s){return void n(s)}c.done?t(l):Promise.resolve(l).then(a,r)}function ie(e){return function(){var t=this,n=arguments;return new Promise((function(a,r){var o=e.apply(t,n);function i(e){oe(o,a,r,i,c,"next",e)}function c(e){oe(o,a,r,i,c,"throw",e)}i(void 0)}))}}var ce=function(e){var t=e.topicId,n=e.commentId,r=(0,a.useContext)(J).currentUser,i=(0,o.v9)(function(e){var t=e.topicId,n=e.commentId,a=e.userId;return function(e){var r,o=e.topics.find((function(e){return e.id===t})),i=e.comments[t][n],c=null!=(r=null==i?void 0:i.likes)?r:[],l=c.length,s=c.find((function(e){return e.user_id===a}));return{topic:o,comment:i,likesCount:l,likeId:null==s?void 0:s.id}}}({topicId:t,userId:r.id,commentId:n})),c=i.topic,l=i.comment,s=i.likesCount,u=i.likeId,p=(0,d.$)().t,f=(0,o.I0)(),v=(0,a.useState)(!1),h=v[0],b=v[1],E=(0,a.useState)(!1),k=E[0],x=E[1],N=(0,a.useState)(l.body),w=N[0],C=N[1],I=void 0!==u,T=function(e){return function(){b(!0),e.apply(void 0,arguments).catch((function(){var e=p("community.flashes.error");(0,g.Am)(e)})).finally((function(){b(!1)}))}},Z=T(ie(y().mark((function e(){var t;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=m().mark_as_solution_api_topic_comment_path(c.id,l.id,{format:"json"}),e.next=3,M.Z.put(t);case 3:f(K.markCommentAsSolution({topicId:c.id,commentId:l.id}));case 4:case"end":return e.stop()}}),e)})))),S=T(ie(y().mark((function e(){var t;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=m().unmark_as_solution_api_topic_comment_path(c.id,l.id,{format:"json"}),e.next=3,M.Z.put(t);case 3:f(K.unmarkCommentAsSolution({topicId:c.id,commentId:l.id}));case 4:case"end":return e.stop()}}),e)})))),U=T(ie(y().mark((function e(){var t,n,a;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=m().api_topic_comment_likes_path(c.id,l.id,{format:"json"}),e.next=3,M.Z.post(t);case 3:n=e.sent,a=n.data,f(K.likeComment({topicId:c.id,commentId:l.id,like:a}));case 6:case"end":return e.stop()}}),e)})))),R=T(ie(y().mark((function e(){var t;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=m().api_topic_comment_like_path(c.id,l.id,u,{format:"json"}),e.next=3,M.Z.delete(t);case 3:f(K.unlikeComment({topicId:c.id,commentId:l.id,likeId:u}));case 4:case"end":return e.stop()}}),e)})))),j=T(function(){var e=ie(y().mark((function e(t,n){var a,r,o;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.body,r=m().api_topic_comment_path(c.id,l.id,{format:"json"}),o={topic_comment:{body:a}},e.next=5,M.Z.put(r,o);case 5:f(K.updateComment({topicId:c.id,commentId:l.id,body:a})),C(""),n.resetForm(),x(!1);case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),A=T(ie(y().mark((function e(){var t;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=m().api_topic_comment_path(c.id,l.id,{format:"json"}),e.next=3,M.Z.delete(t);case 3:f(K.removeComment({topicId:c.id,commentId:l.id}));case 4:case"end":return e.stop()}}),e)}))));return{topic:c,comment:l,likesCount:s,editing:k,setEditedCommentText:C,cancelEditing:function(){C(""),x(!1)},fetching:h,editComment:function(){C(l.body),x(!0)},markAsSolution:Z,unmarkAsSolution:S,removeComment:A,updateComment:j,handleLike:function(){return l.can_like?I?R():U():_()()},editedCommentText:w,commentHasCurrentUserLike:I}},le=function(e){var t=e.handleRemove,n=e.showRemoveConfirmation,r=e.toggleShowRemoveConfirmation,o=(0,d.$)().t;return n?a.createElement(a.Fragment,null,a.createElement(ee.Z.Item,{className:"mt-3",onClick:r},a.createElement("span",{className:"mr-2 fal fa-ban"}),"\xa0",o("community.buttons.cancel_remove_topic")),a.createElement(ee.Z.Item,{className:"dropdown-item",onClick:t},a.createElement("span",{className:"mr-2 fal fa-trash-alt"}),"\xa0",o("community.buttons.apply_remove_topic"))):a.createElement(ee.Z.Item,{onClick:r},o("community.buttons.delete_topic"))},se=function(e){var t=e.comment,n=e.handleRemove,r=e.handleEdit,o=(0,d.$)().t,i=(0,a.useState)(!1),c=i[0],l=i[1],s=(0,a.useState)(!1),m=s[0],u=s[1];if(!t.can_update&&!t.can_destroy)return null;return a.createElement(ee.Z,{title:o("community.buttons.settings"),show:m,onToggle:function(e,t,n){u("select"===n.source||!m),e&&l(!1)}},a.createElement(ee.Z.Toggle,{variant:"link",size:"sm",className:"text-muted p-0",id:t.id},a.createElement("span",{className:"fal fa-cog"})),a.createElement(ee.Z.Menu,null,t.can_update&&a.createElement(ee.Z.Item,{key:"edit",onClick:r},o("community.buttons.edit_topic")),t.can_destroy&&a.createElement(le,{handleRemove:n,showRemoveConfirmation:c,toggleShowRemoveConfirmation:function(){return l(!c)}})))},me=n(3232),ue=function(e){var t=e.content,n=e.length,r=(0,d.$)().t,o=(0,a.useState)(!1),i=o[0],c=o[1],l=t.length>n,s=r("web.communities.btn."+(i?"collapse":"expand")),m=h()({"hexlet-markdown-body":!0,"hexlet-topic-content overflow-hidden":l,collapsed:!i,toggled:l}),p=h()("fal","mr-2",i?"fa-chevron-double-up":"fa-chevron-double-down");return a.createElement(a.Fragment,null,a.createElement("div",{className:m,dangerouslySetInnerHTML:{__html:(0,me.Z)(t,{foldCode:!0,block_of_code_message:r("block_of_code")})}}),l&&a.createElement("div",{className:"text-center mt-2"},a.createElement(u.Z,{className:"x-link-only-hover",onClick:function(){return c(!i)}},a.createElement("span",{className:"mr-1"},a.createElement("span",{className:p})),s)))},de=n(23134),pe=n(19501),fe=n(85826),ve="write",he="preview",be=function(e){var t=e.value,n=e.onChange,r=e.name,o=void 0===r?"":r,i=e.required,c=void 0===i||i,l=e.placeholder,s=void 0===l?"":l,m=e.customKeyPressHandler,u=void 0===m?null:m,d=e.disabled,p=void 0!==d&&d,f=(0,a.useState)(ve),v=f[0],b=f[1],y=(0,a.useRef)(null);(0,a.useEffect)((function(){y.current.focus(),y.current.setSelectionRange(t.length,t.length)}),[]);var g=function(e){return h()(["x-react-mde-button btn btn-primary btn-sm",v===e&&"active"])};return a.createElement(fe.default,{value:t,onChange:n,selectedTab:v,onTabChange:b,generateMarkdownPreview:function(e){return Promise.resolve((0,me.Z)(e))},classes:{preview:"p-3",reactMde:"x-react-mde",toolbar:"px-2"},childProps:{textArea:{name:o,required:c,placeholder:s,onKeyPress:u},writeButton:{className:g(ve)},previewButton:{className:g(he)}},refs:{textarea:y},readOnly:p})},ye=pe.Ry().shape({body:pe.Z_().required("community.validation.required")}),ge=function(e){var t=e.onSubmit,n=e.handleCancel,r=e.initialText,o=void 0===r?"":r,i=e.disabled,c=void 0!==i&&i,l=(0,d.$)().t;return a.createElement(de.J9,{initialValues:{body:o},onSubmit:t,validationSchema:ye},(function(e){var t=e.errors,r=e.touched,o=e.handleSubmit,i=function(e){(e.ctrlKey||e.metaKey)&&"Enter"===e.key&&o()};return a.createElement(de.l0,null,a.createElement(de.gN,{name:"body"},(function(e){var t=e.field,n=e.form;return a.createElement(be,{placeholder:l("community.placeholders.write_comment"),onChange:function(e){n.setFieldValue("body",e)},value:t.value,name:t.name,customKeyPressHandler:i,disabled:c})})),t.body&&r.body&&a.createElement("span",{className:"text-danger"},l(t.body)),a.createElement("div",{className:"form-group mt-3 mb-0"},a.createElement("div",{className:"btn-toolbar d-flex flex-row justify-content-end"},a.createElement("button",{type:"button",className:"btn btn-outline-info mr-3",disabled:c,onClick:n},l("community.buttons.cancel")),a.createElement("button",{type:"submit",className:"btn btn-primary",disabled:c},a.createElement("span",{className:"mr-3 fal fa-paper-plane"}),l("community.buttons.create_comment")))))}))},Ee=function(e){var t=e.hasSolution,n=e.canMarkAsSolution,r=e.markAsSolution,o=e.unmarkAsSolution,i=e.disabled,c=(0,d.$)().t;return t?a.createElement("div",{className:"d-flex align-items-center"},a.createElement("span",{className:"px-3 py-1 text-white bg-success"},a.createElement("span",{className:"mr-2 far fa-check"}),a.createElement("span",null,c("community.marked_as_solution"))),n&&a.createElement(u.Z,{className:"ml-3",onClick:o,disabled:i},c("community.buttons.unmark_as_solution"))):n?a.createElement(u.Z,{className:"px-3 py-1 x-link-without-decoration",onClick:r,disabled:i},a.createElement("span",{className:"far fa-check"}),a.createElement("span",{className:"ml-2"},c("community.buttons.mark_as_solution"))):null},_e=function(e){var t=e.topicId,n=e.commentId,r=e.handleReply,o=ce({topicId:t,commentId:n}),i=o.topic,c=o.comment,l=o.likesCount,s=o.editing,p=o.fetching,f=o.editedCommentText,v=o.commentHasCurrentUserLike,h=o.cancelEditing,b=o.editComment,y=o.markAsSolution,g=o.unmarkAsSolution,E=o.removeComment,_=o.updateComment,k=o.handleLike,x=(0,a.useContext)(J).currentUser,N=(0,d.$)().t,w=i.creator,C=c.creator;return a.createElement(a.Fragment,null,a.createElement("div",{className:"card-body p-0",key:c.id},s?a.createElement(ge,{onSubmit:_,initialText:f,disabled:p,handleCancel:h}):a.createElement("div",null,a.createElement("div",{className:"d-flex justify-content-between align-items-start mb-3"},a.createElement("div",null,a.createElement("a",{href:C.public_profile_url,className:"x-link-only-hover font-weight-bolder mr-2"},C.public_name),x.is_mentor&&c.creator.is_tutor&&a.createElement("span",{className:"mr-2 fas user-graduate"}),C.id===w.id?a.createElement("span",{className:"badge bg-light mr-2",title:N("community.ts_title")},N("community.ts")):C.is_mentor?a.createElement("span",{className:"badge bg-light"},N("community.hexlet_support_badge")):a.createElement("span",{className:"badge bg-light"},N("community.student_badge"))),a.createElement("div",{className:"small d-flex flex-sm-shrink-0 align-items-center"},a.createElement("a",{href:m().topic_path(i,{anchor:c.id}),className:"text-muted x-link-only-hover mr-2"},c.created_at),a.createElement(se,{comment:c,handleRemove:E,handleEdit:b}))),a.createElement(ue,{content:c.body,length:1e3}))),a.createElement("div",{className:"d-flex justify-content-between align-items-stretch small my-3"},a.createElement("div",{className:"d-flex align-items-center"},a.createElement(Ee,{hasSolution:!!c.solution,canMarkAsSolution:c.can_mark_as_solution,markAsSolution:y,unmarkAsSolution:g,disabled:p})),a.createElement("div",{className:"d-flex justify-content-end align-items-center"},a.createElement("div",{className:"d-flex align-items-center"},a.createElement(u.Z,{className:"ml-3",onClick:r},N("community.buttons.reply_to"))),a.createElement(Y,{disabled:p||!c.can_like,isLiked:v,likesCount:l,handleLike:k}))))},ke=function(e){var t=e.topicId,n=e.comments,r=e.handleReplyWith;return a.createElement(re.Z,{in:!0,classNames:"hexlet",timeout:500},a.createElement("div",null,n.map((function(e){return a.createElement("div",{key:e.id,id:"comment_"+e.id,className:"border-top pt-3"},a.createElement(_e,{topicId:t,commentId:e.id,handleReply:r("**"+e.creator.public_name+"**, ")}))}))))},xe=function(e){var t=e.isOpened,n=e.handleOpen,r=e.initialText,o=void 0===r?"":r,i=e.saveComment,c=e.handleClose,l=e.disabled,s=(0,d.$)().t;return t?a.createElement("div",{className:"d-flex flex-column border-0 mt-3"},a.createElement("div",{className:"d-flex flex-fill"},a.createElement("div",{className:"d-flex flex-column flex-fill"},a.createElement("div",{className:"hexlet-topic-comment-content card-body py-0 px-0 pb-3"},a.createElement(ge,{onSubmit:i,initialText:o,handleCancel:c,disabled:l}))))):a.createElement("div",{className:"d-flex flex-column border-0 mt-3"},a.createElement("div",{className:"d-flex flex-fill"},a.createElement("div",{className:"d-flex flex-column flex-fill"},a.createElement("div",{className:"hexlet-topic-comment-content card-body py-0 px-0 pb-3"},a.createElement("div",{className:"form-group mb-0"},a.createElement("input",{type:"text",className:"bg-light form-control rounded-0",onFocus:n,placeholder:s("community.placeholders.write_comment")}))))))},Ne=n(89734),we=n.n(Ne),Ce=["opened","closed"],Ie=["question","gratitude","bug","common"];function Te(e,t,n,a,r,o,i){try{var c=e[o](i),l=c.value}catch(s){return void n(s)}c.done?t(l):Promise.resolve(l).then(a,r)}var Ze=function(e){var t=e.isSubmitting,n=e.submitted,r=(0,d.$)().t;return t?a.createElement("button",{className:"btn btn-outline-primary btn-sm w-100 text-truncate",type:"submit",disabled:!0},a.createElement("span",{className:"mr-2 fa-spin fas fa-spinner"}),r("community.buttons.saving")):a.createElement("button",{className:"btn btn-outline-primary btn-sm w-100 text-truncate",type:"submit",disabled:t},n&&a.createElement("span",{className:"mr-2 far fa-check"}),r(n?"community.buttons.saved":"community.buttons.save"))},Se=function(e){var t,n,r=e.topicData,o=e.changeTopicMentorship,i=e.mentors,c=e.currentUserId,l=(0,d.$)().t;return i?a.createElement(de.J9,{initialValues:{kind:r.kind,mentorId:null!=(t=null==r||null==(n=r.mentor)?void 0:n.id)?t:"",state:r.mentorship_state},initialStatus:{pristine:!0},onSubmit:function(){var e,t=(e=y().mark((function e(t,n){var a,c,s,m,u,d,p,f,v,h,b,E,_;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=t.kind,d=t.mentorId,p=t.state,f=n.resetForm,v=n.setStatus,h=null!=(a=i.find((function(e){return e.id===Number(d)})))?a:null,b={id:r.id,kind:u,mentor:h,mentorId:null!=(c=null==h?void 0:h.id)?c:null,mentorship_state:p,previousMentorId:null!=(s=null==r||null==(m=r.mentor)?void 0:m.id)?s:null},e.prev=4,e.next=7,o(b);case 7:f({values:{kind:u,mentorId:d,state:p}}),v({pristine:!1}),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(4),_=422===(null==e.t0||null==(E=e.t0.response)?void 0:E.status)?"community.flashes.mentor_assignment_conflict":"community.flashes.error",(0,g.Am)(l(_));case 15:case"end":return e.stop()}}),e,null,[[4,11]])})),function(){var t=this,n=arguments;return new Promise((function(a,r){var o=e.apply(t,n);function i(e){Te(o,a,r,i,c,"next",e)}function c(e){Te(o,a,r,i,c,"throw",e)}i(void 0)}))});return function(e,n){return t.apply(this,arguments)}}()},(function(e){var t=e.isSubmitting,n=e.dirty,r=e.status;return a.createElement(de.l0,{className:"py-2 px-3 px-sm-4 border-bottom"},a.createElement("div",{className:"form-row"},a.createElement("div",{className:"col-4"},a.createElement(de.gN,{as:"select",name:"mentorId",className:"form-control form-control-sm"},a.createElement("option",null,l("community.choose_mentor")),we()(i,"full_name").map((function(e){return a.createElement("option",{value:e.id,key:e.id,className:h()(c===e.id&&"font-weight-bold")},e.full_name)})))),a.createElement("div",{className:"col-3"},a.createElement(de.gN,{as:"select",name:"kind",className:"form-control form-control-sm"},Ie.map((function(e){return a.createElement("option",{key:e,value:e},l("community.question_kinds."+e))})))),a.createElement("div",{className:"col-3"},a.createElement(de.gN,{as:"select",name:"state",className:"form-control form-control-sm"},Ce.map((function(e){return a.createElement("option",{key:e,value:e},l("community.question_mentorship_states."+e))})))),a.createElement("div",{className:"col-2"},a.createElement(Ze,{isSubmitting:t,submitted:!r.pristine&&!n}))))})):null},Ue=function(){var e=(0,d.$)().t;return a.createElement("div",{className:"d-inline-block px-3 py-1 rounded-0 text-white bg-success"},a.createElement("span",{className:"mr-2 far fa-check"}),e("community.topic_has_solution"))},Re=function(e){var t=e.handleClick,n=e.isUseful,r=(0,d.$)().t,o=h()("fa-star",n?"fas":"far");return a.createElement(u.Z,{title:r("community.buttons.usefull"),className:"text-muted py-1 px-3 x-link-without-decoration",onClick:t},a.createElement("span",{className:o}))},je=function(e){var t=e.commentsCount,n=e.isCommentsVisible,r=e.toggleCommentVisibility,o=(0,d.$)().t;return t<=1?null:a.createElement("div",{className:"text-center py-3 border-top bg-light"},a.createElement(u.Z,{className:"x-link-without-decoration p-0",onClick:r},n?a.createElement("span",null,o("community.buttons.hide_comments"),a.createElement("span",{className:"ml-2 small far fa-chevron-double-up"})):a.createElement("span",null,o("community.buttons.show_comments",{count:t-1}),a.createElement("span",{className:"ml-2 small far fa-chevron-double-down"}))))},Ae=function(e){var t=e.mentorData,n=(0,d.$)().t;return!!t?a.createElement("span",null,a.createElement("a",{href:m().user_path(t.username),className:"x-link-without-decoration"},n("community.mentor",{full_name:t.full_name}))):a.createElement("div",null,a.createElement("span",null,n("community.waiting_for_mentor_response")))},Me=function(e){var t=e.topicId,n=e.showAllComments,r=void 0!==n&&n,o=(0,d.$)().t,i=X({topicId:t,showAllComments:r}),c=i.topic,l=i.fetching,s=i.likesCount,m=i.comments,p=i.subscriber,v=i.currentUser,b=i.editing,y=i.replying,g=i.replyingText,E=i.commentsSlice,_=i.editedTopicText,k=i.commentsVisible,x=i.topicHasCurrentUserLike,N=i.mentors,w=i.closeReplyForm,C=i.editTopic,I=i.handleLike,T=i.handleReplyWith,Z=i.cancelEditing,S=i.toggleCommentVisibility,U=i.toggleUsefulTopic,R=i.subscribeToTopic,j=i.unsubscribeFromTopic,A=i.removeTopic,M=i.changeTopicMentorship,L=i.updateTopic,F=i.saveComment;if(!c)return null;var P=c.creator,$=c.communitable,q="archived"===c.state,H=P.is_removed,V=h()("card-header","border-bottom","d-flex","flex-column","flex-sm-row","justify-content-between","py-2","px-3","px-sm-4","small");return a.createElement("div",{className:"card mb-5"},v.is_mentor&&a.createElement(Se,{topicData:c,mentors:N,changeTopicMentorship:M,currentUserId:v.id}),a.createElement("div",{className:V},a.createElement("p",{className:"mb-0 py-2"},$&&a.createElement("span",{dangerouslySetInnerHTML:{__html:$.link}})),v.is_mentor&&a.createElement("div",{className:"text-right ml-sm-3 py-2"},a.createElement(Ae,{mentorData:c.mentor}))),a.createElement("div",{className:"card-body pt-3 pb-2 px-3 px-sm-4"},a.createElement("div",{className:"pt-0 pt-sm-2 mb-3"},b?a.createElement(ge,{onSubmit:L,initialText:_,disabled:l,handleCancel:Z}):a.createElement(a.Fragment,null,a.createElement("div",{className:"d-flex justify-content-between align-items-start mb-3"},a.createElement("div",null,a.createElement("a",{href:P.public_profile_url,className:"x-link-only-hover font-weight-bolder mr-2 align-middle"},P.public_name),a.createElement("span",{className:"badge bg-light mr-2",title:o("community.ts_title")},o("community.ts")),v.is_mentor&&c.communitable&&c.communitable.github_project_url&&a.createElement("a",{href:c.communitable.github_project_url,className:"x-link-without-decoration align-middle"},a.createElement("span",{className:"mr-2 fab fa-github"})),v.is_mentor&&!P.has_received_mentor_response_at_least_once&&a.createElement("span",{className:"badge bg-secondary text-white"},"New")),a.createElement("div",{className:"small d-flex flex-sm-shrink-0 align-items-center"},v.is_mentor&&q&&a.createElement("span",{className:"badge bg-danger text-white py-1 mr-2"},c.state),v.is_mentor&&H&&a.createElement("span",{className:"badge bg-danger text-white py-1 mr-2"},"User removed"),a.createElement("a",{href:c.location,className:"x-link-only-hover text-muted mr-2"},c.created_at),a.createElement(ae,{topic:c,handleRemove:A,handleEdit:C,handleSubscribe:R,handleUnsubscribe:j,canUnsubscribe:!!p}))),a.createElement(ue,{content:c.title,length:1e3}))),c.has_solutions&&a.createElement(Ue,null),a.createElement("div",{className:"d-flex justify-content-end align-items-center small mb-3"},v.is_mentor&&a.createElement(Re,{handleClick:U,isUseful:c.useful}),a.createElement("div",{className:"d-flex align-items-center"},a.createElement(u.Z,{className:"ml-2",onClick:T("**"+c.creator.public_name+"**, "),disabled:l},o("community.buttons.reply_to"))),a.createElement(Y,{handleLike:I,likesCount:s,isLiked:x,disabled:l||!c.can_like})),!r&&a.createElement(je,{commentsCount:f()(m),isCommentsVisible:k,toggleCommentVisibility:S}),a.createElement(ke,{topicId:t,comments:E,handleReplyWith:T}),!v.is_guest&&a.createElement(xe,{saveComment:F,isOpened:y,initialText:g,handleOpen:T(""),handleClose:w,disabled:l})))},Le=function(e){var t=e.topic.id;return a.createElement("div",{className:"container"},a.createElement("div",{className:"row justify-content-center"},a.createElement("div",{className:"col-12 col-lg-10 col-xl-9"},a.createElement(Me,{topicId:t,showAllComments:!0}))))},Fe=n(22914);function Pe(e,t,n,a,r,o,i){try{var c=e[o](i),l=c.value}catch(s){return void n(s)}c.done?t(l):Promise.resolve(l).then(a,r)}var $e=pe.Ry().shape({body:pe.Z_().required("community.validation.required")}),qe=function(e){var t=e.communitableType,n=e.communitableId,r=e.topicType,i=(0,d.$)().t,c=(0,o.I0)(),l=function(){var e,a=(e=y().mark((function e(a,o){var l,s,u,d,p;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l=a.body,s=m().api_topics_path({format:"json"}),u={topic:{title:l,communitable_type:t,communitable_id:n,topic_type:r}},e.prev=3,e.next=6,M.Z.post(s,u);case 6:d=e.sent,p=d.data,c(K.addTopic({topic:p})),o.resetForm(),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(3),(0,g.Am)(i("community.flashes.error"));case 15:case"end":return e.stop()}}),e,null,[[3,12]])})),function(){var t=this,n=arguments;return new Promise((function(a,r){var o=e.apply(t,n);function i(e){Pe(o,a,r,i,c,"next",e)}function c(e){Pe(o,a,r,i,c,"throw",e)}i(void 0)}))});return function(e,t){return a.apply(this,arguments)}}();return a.createElement(de.J9,{initialValues:{body:""},onSubmit:l,validationSchema:$e},(function(e){var t=e.errors,n=e.touched,r=e.isSubmitting;return a.createElement(de.l0,null,a.createElement("div",{className:"form-group"},a.createElement(de.gN,{name:"body"},(function(e){var t=e.field,n=e.form;return a.createElement(be,{placeholder:i("community.placeholders.write_question"),onChange:function(e){n.setFieldValue("body",e)},value:t.value,name:t.name,disabled:r})}))),t.body&&n.body&&a.createElement("span",{className:"text-danger"},i(t.body)),a.createElement("div",{className:"form-group"},a.createElement("div",{className:"d-flex flex-column-reverse flex-md-row justify-content-between align-items-start"},a.createElement("div",{className:"col-md-8"},a.createElement("ul",{className:"pl-4 mt-4 mt-md-0"},a.createElement("li",{className:"mt-2"},a.createElement("div",{dangerouslySetInnerHTML:{__html:i("community.help.code_review_html",{link:Fe.Z.hexletCodeReviewHelpUrl})}})),a.createElement("li",null,a.createElement("a",{href:Fe.Z.hexletAskQuestionsHelpUrl,target:"_blank",rel:"noreferrer"},i("community.buttons.how_to_ask_question"),a.createElement("span",{className:"ml-2 fal fa-external-link-square"}))),a.createElement("li",null,a.createElement("a",{href:Fe.Z.hexletMarkdownGuideUrl,target:"_blank",rel:"noreferrer"},i("community.buttons.markdown_help"),a.createElement("span",{className:"ml-2 fal fa-external-link-square"}))),a.createElement("li",null,a.createElement("a",{href:Fe.Z.hexletFaqHelpUrl,target:"_blank",rel:"noreferrer"},i("community.buttons.help"),a.createElement("span",{className:"ml-2 fal fa-external-link-square"}))))),a.createElement("button",{type:"submit",className:"btn btn-primary",disabled:r},a.createElement("span",{className:"mr-3 far fa-paper-plane"}),i("community.buttons.create_topic")))))}))},He=function(e){var t=e.communitableType,n=e.communitableId,r=e.topicType,o=(0,d.$)().t,i=(0,a.useContext)(J).currentUser;return a.createElement("div",{className:"mb-5"},i.is_guest?o("community.log_in_for_adding_topic"):a.createElement(qe,{communitableType:t,communitableId:n,topicType:r}))},Ve=n(58533),Oe=function(e){var t=e.topicsCount,n=e.apiTopicsUrl,r=(0,o.I0)(),i=(0,o.v9)((function(e){return{page:e.page,topics:e.topics}})),c=i.topics,l=i.page,s=(0,a.useState)(!0),m=s[0],u=s[1],d=function(){c.length>=t?u(!1):r(K.loadTopics({page:l,apiTopicsUrl:n}))};return c.length>0?a.createElement(Ve.Z,{dataLength:c.length,next:d,hasMore:m,loader:a.createElement("div",{className:"text-center mb-5"},a.createElement("div",{className:"spinner-border text-primary",style:{width:"3em",height:"3em"},role:"status"},a.createElement("span",{className:"sr-only"},"Loading..."))),scrollableTarget:"community"},c.map((function(e){return a.createElement(Me,{key:e.id,topicId:e.id})}))):null},Be=function(e){var t=e.communitableType,n=e.communitableId,r=e.topicType,o=e.canRenderNewTopicBox,i=e.topicsCount,c=e.apiTopicsUrl,l=(0,a.useContext)(J).currentUser.id&&o;return a.createElement("div",null,l&&a.createElement(He,{communitableType:t,communitableId:n,topicType:r}),a.createElement(Oe,{communitableType:t,communitableId:n,topicType:r,topicsCount:i,apiTopicsUrl:c}))},De={init:function(e,t,n,i,s,m,u){void 0===i&&(i={communitableType:null,communitableId:null,canRenderNewTopicBox:!1});var d=e.reduce((function(e,t){var n;return Object.assign({},e,((n={})[t.id]=c()(t.comments,"id"),n))}),{}),p={currentUser:n,mentors:u},f=(0,l.Z)(W,{preloadedState:{topics:e,comments:d}}),v=a.createElement(J.Provider,{value:p},a.createElement(o.zt,{store:f},a.createElement(Be,{communitableType:i.communitableType,communitableId:i.communitableId,apiTopicsUrl:i.apiTopicsUrl,topicType:t,canRenderNewTopicBox:i.canRenderNewTopicBox,topicsCount:m})));r.render(v,document.getElementById(s))},initTopic:function(e,t,n,i){var s,m=[e],u=((s={})[e.id]=c()(e.comments,"id"),s),d={currentUser:n,mentors:i},p=(0,l.Z)(W,{preloadedState:{topics:m,comments:u}}),f=a.createElement(J.Provider,{value:d},a.createElement(o.zt,{store:p},a.createElement(Le,{topic:e})));r.render(f,document.getElementById("topic"))}}},60546:function(e,t,n){var a=n(9669),r=n.n(a),o=document.querySelector('[name="csrf-token"]')||{content:"no-csrf-token"},i=r().create({headers:{common:{"X-CSRF-Token":o.content}}});t.Z=i},56984:function(e,t,n){var a=n(76403);t.Z=function(e,t){var n=t.preloadedState,r=t.extraArgument,o=(0,a.Bx)({thunk:{extraArgument:r}});return(0,a.xC)({preloadedState:n,reducer:e,middleware:o})}},64663:function(e,t,n){var a=n(30837),r=n(99622),o=n(75037),i=n(6140),c=n(10769),l=n(82532),s=n(47271),m=n(34085),u=n(35010),d=(n(85241),{javascript:r.Z,ruby:s.Z,shell:i.Z,php:c.Z,java:l.Z,sql:m.Z,python:o.Z,scss:u.Z});Object.keys(d).forEach((function(e){return a.Z.registerLanguage(e,d[e])})),t.Z=a.Z},3232:function(e,t,n){var a=n(9980),r=n.n(a),o=n(64663);t.Z=function(e,t){return function(e){var t={tables:!0,sanitize:!1,html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkify:!0,linkTarget:"_blank",highlight:function(t,n){var a=n&&o.Z.getLanguage(n)?function(){return o.Z.highlight(t,{language:n}).value}:function(){return o.Z.configure({languages:["javascript","php","lisp","xml","java","ruby","python","css","c++","c","yml"]}),o.Z.highlightAuto(t).value};try{var r=o.Z.lineNumbersValue(a());return'<pre class="hljs"><code>'+(null!=e&&e.foldCode?function(e,t){return'<details><summary tabindex="-1">'+t+'</summary><div class="m-2">'+e+"</div></details>"}(r,e.block_of_code_message):r)+"</code></pre>"}catch(i){}return""}};return new(r())(Object.assign({},t,e))}(t).render(e)}},22914:function(e,t,n){n.d(t,{I:function(){return r}});var a={hexletHowToDebugHelpUrl:"https://help.hexlet.io/ru/articles/111500-kak-nayti-oshibki-v-kode",hexletAskQuestionsHelpUrl:"https://help.hexlet.io/ru/articles/111495-kak-pravilno-zadavat-voprosy",hexletCodeReviewHelpUrl:"https://help.hexlet.io/ru/articles/111135-kod-revyu",hexletFaqHelpUrl:"https://help.hexlet.io/ru/articles/111490-ne-mogu-vypolnit-praktiku",hexletMarkdownGuideUrl:"https://guides.hexlet.io/markdown/",googleDocsUrl:"https://docs.google.com",corsProxyUrl:"https://hexlet-corsanywhere.herokuapp.com"},r=function(e){var t=new URL("/forms/d/e/"+e+"/formResponse",a.googleDocsUrl);return t.searchParams.set("embedded","true"),t};t.Z=a}}]);
//# sourceMappingURL=354-0b955770b7c077f09ef0.js.map